
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/dimension_reduction/grassmann/plot_grassmann_karcher.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_dimension_reduction_grassmann_plot_grassmann_karcher.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_dimension_reduction_grassmann_plot_grassmann_karcher.py:


Karcher
==================================

This example shows how to use the UQpy Grassmann class to use the logarithmic map and the exponential map

.. GENERATED FROM PYTHON SOURCE LINES 10-12

Import the necessary libraries. Here we import standard libraries such as numpy and matplotlib, but also need to
import the Grassmann class from UQpy implemented in the DimensionReduction module.

.. GENERATED FROM PYTHON SOURCE LINES 15-22

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np

    from UQpy.dimension_reduction import GrassmannOperations
    from UQpy.dimension_reduction.grassmann_manifold.projections.SVDProjection import SVDProjection








.. GENERATED FROM PYTHON SOURCE LINES 23-25

Generate four random matrices with reduced rank corresponding to the different samples. The samples are stored in
`matrices`.

.. GENERATED FROM PYTHON SOURCE LINES 28-57

.. code-block:: Python


    D1 = 6
    r0 = 2  # rank sample 0
    r1 = 3  # rank sample 1
    r2 = 4  # rank sample 2
    r3 = 3  # rank sample 2

    np.random.seed(1111)  # For reproducibility.
    # Solutions: original space.
    Sol0 = np.dot(np.random.rand(D1, r0), np.random.rand(r0, D1))
    Sol1 = np.dot(np.random.rand(D1, r1), np.random.rand(r1, D1))
    Sol2 = np.dot(np.random.rand(D1, r2), np.random.rand(r2, D1))
    Sol3 = np.dot(np.random.rand(D1, r3), np.random.rand(r3, D1))

    # Creating a list of matrices.
    matrices = [Sol0, Sol1, Sol2, Sol3]

    # Plot the matrices
    fig, (ax1, ax2, ax3, ax4) = plt.subplots(1, 4)
    ax1.title.set_text('Matrix 0')
    ax1.imshow(Sol0)
    ax2.title.set_text('Matrix 1')
    ax2.imshow(Sol1)
    ax3.title.set_text('Matrix 2')
    ax3.imshow(Sol2)
    ax4.title.set_text('Matrix 3')
    ax4.imshow(Sol3)
    plt.show()




.. image-sg:: /auto_examples/dimension_reduction/grassmann/images/sphx_glr_plot_grassmann_karcher_001.png
   :alt: Matrix 0, Matrix 1, Matrix 2, Matrix 3
   :srcset: /auto_examples/dimension_reduction/grassmann/images/sphx_glr_plot_grassmann_karcher_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 58-59

Instatiate the UQpy class Grassmann.

.. GENERATED FROM PYTHON SOURCE LINES 62-77

.. code-block:: Python


    manifold_projection = SVDProjection(matrices, p="max")

    # Plot the points on the Grassmann manifold defined by the left singular eigenvectors.
    fig, (ax1, ax2, ax3, ax4) = plt.subplots(1, 4)
    ax1.title.set_text('Matrix 0')
    ax1.imshow(manifold_projection.u[0].data)
    ax2.title.set_text('Matrix 1')
    ax2.imshow(manifold_projection.u[0].data)
    ax3.title.set_text('Matrix 2')
    ax3.imshow(manifold_projection.u[0].data)
    ax4.title.set_text('Matrix 3')
    ax4.imshow(manifold_projection.u[0].data)
    plt.show()




.. image-sg:: /auto_examples/dimension_reduction/grassmann/images/sphx_glr_plot_grassmann_karcher_002.png
   :alt: Matrix 0, Matrix 1, Matrix 2, Matrix 3
   :srcset: /auto_examples/dimension_reduction/grassmann/images/sphx_glr_plot_grassmann_karcher_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 78-79

Compute the Karcher mean.

.. GENERATED FROM PYTHON SOURCE LINES 82-93

.. code-block:: Python


    from UQpy.utilities.distances.grassmannian_distances.GeodesicDistance import GeodesicDistance

    distance_method = GeodesicDistance()
    karcher_psi = GrassmannOperations.karcher_mean(grassmann_points=manifold_projection.u,
                                                   distance=distance_method,
                                                   optimization_method="GradientDescent")
    karcher_phi = GrassmannOperations.karcher_mean(grassmann_points=manifold_projection.v,
                                                   distance=distance_method,
                                                   optimization_method="GradientDescent")








.. GENERATED FROM PYTHON SOURCE LINES 94-95

Project :math:`\Psi`, the left singular eigenvectors, on the tangent space centered at the Karcher mean.

.. GENERATED FROM PYTHON SOURCE LINES 98-119

.. code-block:: Python


    points_tangent = GrassmannOperations.log_map(grassmann_points=manifold_projection.u,
                                                 reference_point=karcher_psi)

    print(points_tangent[0])
    print(points_tangent[1])
    print(points_tangent[2])
    print(points_tangent[3])

    # Plot the matrices
    fig, (ax1, ax2, ax3, ax4) = plt.subplots(1, 4)
    ax1.title.set_text('Matrix 0')
    ax1.imshow(points_tangent[0])
    ax2.title.set_text('Matrix 1')
    ax2.imshow(points_tangent[1])
    ax3.title.set_text('Matrix 2')
    ax3.imshow(points_tangent[2])
    ax4.title.set_text('Matrix 3')
    ax4.imshow(points_tangent[3])
    plt.show()




.. image-sg:: /auto_examples/dimension_reduction/grassmann/images/sphx_glr_plot_grassmann_karcher_003.png
   :alt: Matrix 0, Matrix 1, Matrix 2, Matrix 3
   :srcset: /auto_examples/dimension_reduction/grassmann/images/sphx_glr_plot_grassmann_karcher_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [[-0.08476834 -0.09931163 -0.39563433 -0.01158668]
     [-0.0968323  -0.16676559 -0.23402751  0.0776898 ]
     [ 0.19103436  0.33575077  0.43411422 -0.16477893]
     [ 0.05880381  0.08030524  0.22780937 -0.01142413]
     [-0.1019712  -0.12945505 -0.43510011  0.0030961 ]
     [ 0.11271636  0.10269816  0.64605003  0.06546744]]
    [[-0.0107708   0.06181325  0.08652022 -0.00151458]
     [-0.03277549  0.22614494  0.09061133  0.11635251]
     [ 0.06725209 -0.46583515 -0.17772061 -0.24449178]
     [ 0.01185352 -0.07617071 -0.05825921 -0.02422391]
     [-0.01679186  0.10349582  0.10253826  0.02029991]
     [ 0.00305078  0.00343936 -0.11957271  0.06702646]]
    [[ 1.90551724e-02 -1.10422017e-01  6.37804556e-02 -1.99271432e-01]
     [ 6.75078590e-02 -1.14049358e-02  2.71617585e-01 -4.34153973e-02]
     [-1.38972013e-01  7.97698496e-03 -5.61016871e-01  6.23329692e-02]
     [-2.30090051e-02  5.20423793e-02 -8.67874048e-02  9.88048441e-02]
     [ 3.14914110e-02 -1.11336889e-01  1.13960207e-01 -2.05200151e-01]
     [-1.54215449e-04  2.09995792e-01  2.46221359e-02  3.66394273e-01]]
    [[ 0.07717055  0.1476542   0.24395364  0.21117574]
     [ 0.06200429 -0.04933727 -0.12919479 -0.15256888]
     [-0.11901437  0.1249301   0.30650925  0.35084167]
     [-0.04793628 -0.05576562 -0.08193023 -0.06220347]
     [ 0.08793273  0.13677754  0.2170508   0.18025661]
     [-0.11701036 -0.31636227 -0.54894346 -0.49761297]]




.. GENERATED FROM PYTHON SOURCE LINES 120-121

Map the points back to the Grassmann manifold.

.. GENERATED FROM PYTHON SOURCE LINES 124-138

.. code-block:: Python


    points_grassmann = GrassmannOperations.exp_map(tangent_points=points_tangent,
                                                   reference_point=manifold_projection.u[0])

    # Plot the matrices
    fig, (ax1, ax2, ax3, ax4) = plt.subplots(1, 4)
    ax1.title.set_text('Matrix 0')
    ax1.imshow(points_grassmann[0].data)
    ax2.title.set_text('Matrix 1')
    ax2.imshow(points_grassmann[1].data)
    ax3.title.set_text('Matrix 2')
    ax3.imshow(points_grassmann[2].data)
    ax4.title.set_text('Matrix 3')
    ax4.imshow(points_grassmann[3].data)
    plt.show()


.. image-sg:: /auto_examples/dimension_reduction/grassmann/images/sphx_glr_plot_grassmann_karcher_004.png
   :alt: Matrix 0, Matrix 1, Matrix 2, Matrix 3
   :srcset: /auto_examples/dimension_reduction/grassmann/images/sphx_glr_plot_grassmann_karcher_004.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.438 seconds)


.. _sphx_glr_download_auto_examples_dimension_reduction_grassmann_plot_grassmann_karcher.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/SURGroup/UQpy/master?urlpath=lab/tree/notebooks/auto_examples/dimension_reduction/grassmann/plot_grassmann_karcher.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_grassmann_karcher.ipynb <plot_grassmann_karcher.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_grassmann_karcher.py <plot_grassmann_karcher.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_grassmann_karcher.zip <plot_grassmann_karcher.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
