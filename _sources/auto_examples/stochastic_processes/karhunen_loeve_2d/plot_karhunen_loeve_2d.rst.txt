
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/stochastic_processes/karhunen_loeve_2d/plot_karhunen_loeve_2d.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_stochastic_processes_karhunen_loeve_2d_plot_karhunen_loeve_2d.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_stochastic_processes_karhunen_loeve_2d_plot_karhunen_loeve_2d.py:


Karhunen Loeve Expansion 2 Dimesional
=================================================================

In this example, the KL Expansion is used to generate 2 dimensional stochastic fields from a prescribed Autocorrelation
Function. This example illustrates how to use the :class:`.KarhunenLoeveExpansion2D` class for a 2 dimensional
random field and compare the statistics of the generated random field with the expected values.

.. GENERATED FROM PYTHON SOURCE LINES 13-15

Import the necessary libraries. Here we import standard libraries such as numpy and matplotlib, but also need to
import the :class:`.KarhunenLoeveExpansionTwoDimension` class from the :py:mod:`stochastic_processes` module of UQpy.

.. GENERATED FROM PYTHON SOURCE LINES 18-23

.. code-block:: Python

    from matplotlib import pyplot as plt
    from UQpy.stochastic_process import KarhunenLoeveExpansion2D
    import numpy as np









.. GENERATED FROM PYTHON SOURCE LINES 24-25

The input parameters necessary for the generation of the stochastic processes are given below:

.. GENERATED FROM PYTHON SOURCE LINES 28-37

.. code-block:: Python


    n_samples = 100  # Num of samples
    nx, nt = 20, 10
    dx, dt = 0.05, 0.1

    x = np.linspace(0, (nx - 1) * dx, nx)
    t = np.linspace(0, (nt - 1) * dt, nt)
    xt_list = np.meshgrid(x, x, t, t, indexing='ij')  # R(t_1, t_2, x_1, x_2)








.. GENERATED FROM PYTHON SOURCE LINES 38-41

.. code-block:: Python


    # Defining the Autocorrelation Function.








.. GENERATED FROM PYTHON SOURCE LINES 42-49

.. code-block:: Python


    R = np.exp(-(xt_list[0] - xt_list[1]) ** 2 - (xt_list[2] - xt_list[3]) ** 2)
    # R(x_1, x_2, t_1, t_2) = exp(-(x_1 - x_2) ** 2 -(t_1 - t_2) ** 2)

    KLE_Object = KarhunenLoeveExpansion2D(n_samples=n_samples, correlation_function=R, time_intervals=np.array([dt, dx]),
                                          thresholds=[4, 5], random_state=128)








.. GENERATED FROM PYTHON SOURCE LINES 50-53

.. code-block:: Python


    # Simulating the samples.








.. GENERATED FROM PYTHON SOURCE LINES 54-57

.. code-block:: Python


    samples = KLE_Object.samples








.. GENERATED FROM PYTHON SOURCE LINES 58-61

.. code-block:: Python


    # Plotting a sample of the stochastic field.








.. GENERATED FROM PYTHON SOURCE LINES 62-72

.. code-block:: Python


    fig = plt.figure()
    plt.title('Realisation of the Karhunen Loeve Expansion for a 2D stochastic field')
    plt.imshow(samples[0, 0])
    plt.ylabel('t (Time)')
    plt.xlabel('x (Space)')
    plt.show()

    print('The mean of the samples is ', np.mean(samples), 'whereas the expected mean is 0.000')
    print('The variance of the samples is ', np.var(samples), 'whereas the expected variance is 1.000')



.. image-sg:: /auto_examples/stochastic_processes/karhunen_loeve_2d/images/sphx_glr_plot_karhunen_loeve_2d_001.png
   :alt: Realisation of the Karhunen Loeve Expansion for a 2D stochastic field
   :srcset: /auto_examples/stochastic_processes/karhunen_loeve_2d/images/sphx_glr_plot_karhunen_loeve_2d_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    The mean of the samples is  0.06238506034183267 whereas the expected mean is 0.000
    The variance of the samples is  0.8734778751443557 whereas the expected variance is 1.000





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.060 seconds)


.. _sphx_glr_download_auto_examples_stochastic_processes_karhunen_loeve_2d_plot_karhunen_loeve_2d.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/SURGroup/UQpy/master?urlpath=lab/tree/notebooks/auto_examples/stochastic_processes/karhunen_loeve_2d/plot_karhunen_loeve_2d.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_karhunen_loeve_2d.ipynb <plot_karhunen_loeve_2d.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_karhunen_loeve_2d.py <plot_karhunen_loeve_2d.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_karhunen_loeve_2d.zip <plot_karhunen_loeve_2d.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
