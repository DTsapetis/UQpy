
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/stochastic_processes/karhunen_loeve_1d/plot_karhunen_loeve_1d.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_stochastic_processes_karhunen_loeve_1d_plot_karhunen_loeve_1d.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_stochastic_processes_karhunen_loeve_1d_plot_karhunen_loeve_1d.py:


Karhunen Loeve Expansion
=================================================================

In this example, the KL Expansion is used to generate stochastic processes from a prescribed Autocorrelation Function.
This example illustrates how to use the :class:`.KarhunenLoeveExpansion` class for a one dimensional and compare the
statistics of the generated stochastic processes with the expected values.

.. GENERATED FROM PYTHON SOURCE LINES 13-15

Import the necessary libraries. Here we import standard libraries such as numpy and matplotlib, but also need to
import the :class:`.KarhunenLoeveExpansion` class from the :py:mod:`stochastic_processes` module of UQpy.

.. GENERATED FROM PYTHON SOURCE LINES 18-23

.. code-block:: Python


    from UQpy.stochastic_process import KarhunenLoeveExpansion
    import numpy as np
    import matplotlib.pyplot as plt








.. GENERATED FROM PYTHON SOURCE LINES 24-25

The input parameters necessary for the generation of the stochastic processes are given below:

.. GENERATED FROM PYTHON SOURCE LINES 28-36

.. code-block:: Python


    n_sim = 10000  # Num of samples

    m = 400 + 1
    T = 1000
    dt = T / (m - 1)
    t = np.linspace(0, T, m)








.. GENERATED FROM PYTHON SOURCE LINES 37-38

Defining the Autocorrelation Function.

.. GENERATED FROM PYTHON SOURCE LINES 41-59

.. code-block:: Python


    # Target Covariance(ACF)
    R = np.zeros([m, m])
    for i in range(m):
        for j in range(m):
            R[i, j] = 2 * np.exp(-((t[j] - t[i]) / 281) ** 2)  # var = 2

    KLE_Object = KarhunenLoeveExpansion(n_samples=n_sim, correlation_function=R, time_interval=dt)
    samples = KLE_Object.samples

    fig, ax = plt.subplots()
    plt.title('Realisation of the Karhunen Loeve Expansion')
    plt.plot(t, samples[0, 0])
    ax.yaxis.grid(True)
    ax.xaxis.grid(True)
    plt.show()

    print('The mean of the samples is ', np.mean(samples), 'whereas the expected mean is 0.000')
    print('The variance of the samples is ', np.var(samples), 'whereas the expected variance is 2.000')


.. image-sg:: /auto_examples/stochastic_processes/karhunen_loeve_1d/images/sphx_glr_plot_karhunen_loeve_1d_001.png
   :alt: Realisation of the Karhunen Loeve Expansion
   :srcset: /auto_examples/stochastic_processes/karhunen_loeve_1d/images/sphx_glr_plot_karhunen_loeve_1d_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    The mean of the samples is  0.0027295876584189495 whereas the expected mean is 0.000
    The variance of the samples is  2.0023957073687115 whereas the expected variance is 2.000





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.886 seconds)


.. _sphx_glr_download_auto_examples_stochastic_processes_karhunen_loeve_1d_plot_karhunen_loeve_1d.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/SURGroup/UQpy/master?urlpath=lab/tree/notebooks/auto_examples/stochastic_processes/karhunen_loeve_1d/plot_karhunen_loeve_1d.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_karhunen_loeve_1d.ipynb <plot_karhunen_loeve_1d.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_karhunen_loeve_1d.py <plot_karhunen_loeve_1d.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_karhunen_loeve_1d.zip <plot_karhunen_loeve_1d.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
