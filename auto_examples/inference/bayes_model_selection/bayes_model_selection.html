

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bayes Model Selection - Regression Models &mdash; UQpy v4.1.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=72eccc5f"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Reliability" href="../../../reliability/index.html" />
    <link rel="prev" title="Auxiliary file" href="local_pfn_models.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F0F0F0" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dimension_reduction/index.html">Dimension Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distributions/index.html">Distributions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../inference/index.html">Inference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../inference/inference_models.html"> Inference Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../inference/mle.html"> Maximum Likelihood Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../inference/bayes_parameter_estimation.html"> Bayes Parameter Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../inference/info_model_selection.html"> Information Theoretic Model Selection</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../inference/bayes_model_selection.html"> Bayes Model Selection</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../inference/bayes_model_selection.html#UQpy.inference.HarmonicMean"><code class="docutils literal notranslate"><span class="pre">HarmonicMean</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../inference/bayes_model_selection.html#evidencemethod-class">EvidenceMethod Class</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../../inference/bayes_model_selection.html#bayesmodelselection-class">BayesModelSelection Class</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../inference/bayes_model_selection.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../inference/bayes_model_selection.html#attributes">Attributes</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../../inference/bayes_model_selection.html#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../reliability/index.html">Reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../runmodel_doc.html">RunModel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sampling/index.html">Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scientific_machine_learning/index.html">Scientific Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sensitivity/index.html">Sensitivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../stochastic_process/index.html">Stochastic Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../surrogates/index.html">Surrogates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../transformations/index.html">Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../utilities/index.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture.html">UQpy architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../paper.html">UQpy paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../news_doc.html">News</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #F0F0F0" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">UQpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../inference/index.html">Inference</a></li>
          <li class="breadcrumb-item"><a href="../../../inference/bayes_model_selection.html">BayesModelSelection</a></li>
          <li class="breadcrumb-item"><a href="index.html">Bayesian Model Selection</a></li>
      <li class="breadcrumb-item active">Bayes Model Selection - Regression Models</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/auto_examples/inference/bayes_model_selection/bayes_model_selection.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-inference-bayes-model-selection-bayes-model-selection-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code. or to run this example in your browser via Binder</p>
</div>
<section class="sphx-glr-example-title" id="bayes-model-selection-regression-models">
<span id="sphx-glr-auto-examples-inference-bayes-model-selection-bayes-model-selection-py"></span><h1>Bayes Model Selection - Regression Models<a class="headerlink" href="#bayes-model-selection-regression-models" title="Link to this heading"></a></h1>
<p>In the following we present an example for which the posterior pdf of the parameters, evidences and model probabilities
can be computed analytically. We drop the <span class="math notranslate nohighlight">\(m_{j}\)</span> subscript when referring to model parameters for simplicity. Three
models are considered (the domain <span class="math notranslate nohighlight">\(x\)</span> is fixed and consists in 50 equally spaced points):</p>
<div class="math notranslate nohighlight">
\[m_{linear}: \quad y = θ_{0} x + \epsilon\]</div>
<div class="math notranslate nohighlight">
\[m_{quadratic}: \quad y = θ_{0} x + θ_{1} x^2 + \epsilon\]</div>
<div class="math notranslate nohighlight">
\[m_{cubic}: \quad y = θ_{0} x + θ_{1} x^2+ θ_{2} x^3 + \epsilon\]</div>
<p>All three models can be written in a compact form as <span class="math notranslate nohighlight">\(y=X θ + \epsilon\)</span>, where <span class="math notranslate nohighlight">\(X\)</span> contains the
necessary powers of <span class="math notranslate nohighlight">\(x\)</span>. For all three models, the prior is chosen to be Gaussian,
<span class="math notranslate nohighlight">\(p(θ) = N(\cdot, θ_{prior}, \Sigma_{prior})\)</span>, and so is the noise
<span class="math notranslate nohighlight">\(\epsilon \sim N(\cdot; 0, \sigma_{n}^{2} I)\)</span>.</p>
<p>Initially we have to import the necessary modules.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">UQpy.sampling.mcmc</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetropolisHastings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">UQpy.inference</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesModelSelection</span><span class="p">,</span> <span class="n">BayesParameterEstimation</span><span class="p">,</span> <span class="n">ComputationalModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">UQpy.run_model.RunModel</span><span class="w"> </span><span class="kn">import</span> <span class="n">RunModel</span>  <span class="c1"># required to run the quadratic model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">UQpy.distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Normal</span><span class="p">,</span> <span class="n">JointIndependent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">multivariate_normal</span><span class="p">,</span> <span class="n">norm</span>
</pre></div>
</div>
<p>Generate data from a quadratic function</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">param_true</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">var_n</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">error_covariance</span> <span class="o">=</span> <span class="n">var_n</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.eye.html#numpy.eye" title="numpy.eye" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">eye</span></a><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">param_true</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">UQpy.run_model.model_execution.PythonModel</span><span class="w"> </span><span class="kn">import</span> <span class="n">PythonModel</span>
<span class="n">m</span><span class="o">=</span><span class="n">PythonModel</span><span class="p">(</span><span class="n">model_script</span><span class="o">=</span><span class="s1">&#39;local_pfn_models.py&#39;</span><span class="p">,</span> <span class="n">model_object_name</span><span class="o">=</span><span class="s1">&#39;model_quadratic&#39;</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;theta_1&#39;</span><span class="p">,</span> <span class="s1">&#39;theta_2&#39;</span><span class="p">])</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">RunModel</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="n">param_true</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="n">data_clean</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">qoi_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data_clean</span> <span class="o">+</span> <span class="n">Normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.sqrt.html#numpy.sqrt" title="numpy.sqrt" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><span class="n">var_n</span><span class="p">))</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">nsamples</span><span class="o">=</span><span class="n">data_clean</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">456</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,))</span>
</pre></div>
</div>
<p>Define the models, compute the true values of the evidence.</p>
<p>For all three models, a Gaussian prior is chosen for the parameters, with mean and covariance matrix of the
appropriate dimensions. Each model is given prior probability <span class="math notranslate nohighlight">\(P(m_{j}) = 1/3\)</span>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;model_linear&#39;</span><span class="p">,</span> <span class="s1">&#39;model_quadratic&#39;</span><span class="p">,</span> <span class="s1">&#39;model_cubic&#39;</span><span class="p">]</span>
<span class="n">model_n_params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">model_prior_means</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]</span>
<span class="n">model_prior_stds</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">10.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]]</span>


<span class="n">candidate_models</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model_names</span><span class="p">):</span>
    <span class="n">m</span><span class="o">=</span><span class="n">PythonModel</span><span class="p">(</span><span class="n">model_script</span><span class="o">=</span><span class="s1">&#39;local_pfn_models.py&#39;</span><span class="p">,</span> <span class="n">model_object_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,)</span>
    <span class="n">run_model</span> <span class="o">=</span> <span class="n">RunModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
    <span class="n">prior</span> <span class="o">=</span> <span class="n">JointIndependent</span><span class="p">([</span><span class="n">Normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">std</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">std</span> <span class="ow">in</span>
                              <span class="nb">zip</span><span class="p">(</span><span class="n">model_prior_means</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">model_prior_stds</span><span class="p">[</span><span class="n">n</span><span class="p">])])</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">ComputationalModel</span><span class="p">(</span><span class="n">n_parameters</span><span class="o">=</span><span class="n">model_n_params</span><span class="p">[</span><span class="n">n</span><span class="p">],</span>
                               <span class="n">runmodel_object</span><span class="o">=</span><span class="n">run_model</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior</span><span class="p">,</span>
                               <span class="n">error_covariance</span><span class="o">=</span><span class="n">error_covariance</span><span class="p">,</span>
                               <span class="n">name</span><span class="o">=</span><span class="n">model_name</span><span class="p">)</span>
    <span class="n">candidate_models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">proposals</span> <span class="o">=</span> <span class="p">[</span><span class="n">Normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span>
             <span class="n">JointIndependent</span><span class="p">([</span><span class="n">Normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">Normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)]),</span>
             <span class="n">JointIndependent</span><span class="p">([</span><span class="n">Normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.15</span><span class="p">),</span> <span class="n">Normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">Normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)])]</span>
<span class="n">nsamples</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span>
<span class="n">nburn</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">jump</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>


<span class="n">sampling_inputs</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>
<span class="n">estimators</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">sampling</span> <span class="o">=</span> <span class="n">MetropolisHastings</span><span class="p">(</span><span class="n">jump</span><span class="o">=</span><span class="n">jump</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                  <span class="n">burn_length</span><span class="o">=</span><span class="n">nburn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                  <span class="n">proposal</span><span class="o">=</span><span class="n">proposals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                  <span class="n">seed</span><span class="o">=</span><span class="n">model_prior_means</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                  <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
    <span class="n">estimators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BayesParameterEstimation</span><span class="p">(</span><span class="n">inference_model</span><span class="o">=</span><span class="n">candidate_models</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                                  <span class="n">sampling_class</span><span class="o">=</span><span class="n">sampling</span><span class="p">))</span>

<span class="n">selection</span> <span class="o">=</span> <span class="n">BayesModelSelection</span><span class="p">(</span><span class="n">parameter_estimators</span><span class="o">=</span><span class="n">estimators</span><span class="p">,</span>
                                <span class="n">prior_probabilities</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">],</span>
                                <span class="n">nsamples</span><span class="o">=</span><span class="n">nsamples</span><span class="p">)</span>

<span class="n">sorted_indices</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.argsort.html#numpy.argsort" title="numpy.argsort" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">argsort</span></a><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">probabilities</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sorted models:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([</span><span class="n">selection</span><span class="o">.</span><span class="n">candidate_models</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sorted_indices</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Evidence of sorted models:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([</span><span class="n">selection</span><span class="o">.</span><span class="n">evidences</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sorted_indices</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Posterior probabilities of sorted models:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([</span><span class="n">selection</span><span class="o">.</span><span class="n">probabilities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sorted_indices</span><span class="p">])</span>
</pre></div>
</div>
<p>As of version 2, the implementation of BayesModelSelection in UQpy uses the method of the harmonic mean to compute
the models’ evidence. This method is known to behave quite poorly, in particular it yeidls estimates with large
variance. In the problem above, this implementation does not consistently detects that the quadratic model has the
highest model probability. Future versions of UQpy will integrate more advanced methods for the estimation of the
evidence.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">be</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">candidate_models</span><span class="p">,</span> <span class="n">selection</span><span class="o">.</span><span class="n">bayes_estimators</span><span class="p">)):</span>
    <span class="c1"># plot prior, true posterior and estimated posterior</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Posterior parameters for model &#39;</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">n_p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">n_parameters</span><span class="p">):</span>
        <span class="n">domain_plot</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">samples</span><span class="p">[:,</span> <span class="n">n_p</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">samples</span><span class="p">[:,</span> <span class="n">n_p</span><span class="p">]),</span> <span class="mi">200</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">n_p</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">domain_plot</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">domain_plot</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">model_prior_means</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n_p</span><span class="p">],</span>
                                           <span class="n">scale</span><span class="o">=</span><span class="n">model_prior_stds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n_p</span><span class="p">]),</span>
                     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;prior&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">n_p</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">domain_plot</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">domain_plot</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">model_posterior_means</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n_p</span><span class="p">],</span>
                                           <span class="n">scale</span><span class="o">=</span><span class="n">model_posterior_stds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n_p</span><span class="p">]),</span>
                     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;true posterior&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">n_p</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">be</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">samples</span><span class="p">[:,</span> <span class="n">n_p</span><span class="p">],</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;estimated posterior MCMC&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">n_p</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<a href="https://docs.python.org/3/library/shutil.html#shutil.rmtree" title="shutil.rmtree" class="sphx-glr-backref-module-shutil sphx-glr-backref-type-py-function"><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span></a><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">model_dir</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/shutil.html#shutil.rmtree" title="shutil.rmtree" class="sphx-glr-backref-module-shutil sphx-glr-backref-type-py-function"><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span></a><span class="p">(</span><span class="n">candidate_models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">runmodel_object</span><span class="o">.</span><span class="n">model_dir</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/shutil.html#shutil.rmtree" title="shutil.rmtree" class="sphx-glr-backref-module-shutil sphx-glr-backref-type-py-function"><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span></a><span class="p">(</span><span class="n">candidate_models</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">runmodel_object</span><span class="o">.</span><span class="n">model_dir</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/shutil.html#shutil.rmtree" title="shutil.rmtree" class="sphx-glr-backref-module-shutil sphx-glr-backref-type-py-function"><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span></a><span class="p">(</span><span class="n">candidate_models</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">runmodel_object</span><span class="o">.</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-inference-bayes-model-selection-bayes-model-selection-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/SURGroup/UQpy/master?urlpath=lab/tree/notebooks/auto_examples/inference/bayes_model_selection/bayes_model_selection.ipynb"><img alt="Launch binder" src="../../../_images/binder_badge_logo8.svg" style="width: 150px;" />
</a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/7995aa39d97cbcd1e1ac681d0bc241f6/bayes_model_selection.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">bayes_model_selection.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/53c74822614c0c427285db952653539d/bayes_model_selection.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">bayes_model_selection.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/2f0ad8cab3229610342d77738d442ff9/bayes_model_selection.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">bayes_model_selection.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="local_pfn_models.html" class="btn btn-neutral float-left" title="Auxiliary file" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../reliability/index.html" class="btn btn-neutral float-right" title="Reliability" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Michael D. Shields.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>